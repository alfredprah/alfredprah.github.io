---
layout: post
title: "Central Limit Theorem (R stats)"
subtitle: "The central limit theorem is an important computational short-cut for generating and making inference from the sampling distribution of the mean.. "
date: 2020-03-13 00:01:23 -0500
background: '/img/posts/distribution-159626_960_720.png'
<!-- 
pagination:
  enabled: false
  collection: posts -->
---

<h1> Introduction </h1>

<p> The central limit theorem is an important computational short-cut for generating and making inference from the sampling distribution of the mean. 
  The central limit theorem short-cut relies on a number of conditions, specifically: 
  <ul>
  <li>Independent observations</li>
  <li>Identically distributed observations</li>
  <li>The pre-existence of the Mean and variance</li>
  <li>A sample size large enough for convergence</li>
 </ul>   
</p>

<p>In this simulation study, I use QQ-plots to graphically compare the sampling distribution of the mean generated by simulation to the sampling distribution 
  implied by the central limit theorem. For the purposes of this simulation, letâ€™s treat the mean and variance as known values and use the actual population 
  parameters and the population mean and variance instead of sample estimates. </p>

<p>To generate a sample, I initialize the parameters (size of sampling distribution, central location and scale of the skew-normal distribution) that do not 
  change at the beginning.</p> 

<h2> Parameters that do not change </h2>

<ul>
  <li>R <- 5000</li>
  <li>location <- 0</li>
  <li>scale <- 1</li>
</ul>  


<h2> Comparison </h2>
<p>To pave the way for comparison, I conduct a 4 x 4 factorial experiment to compare the distributions in the QQ-plots. The first factor is the sample size, 
  with N = 5, 10, 20, and 40. The second factor is the degree of skewness in the underlying distribution. The underlying distribution is the Skew-Normal 
  distribution.</p>

<p>The Skew-Normal distribution has three parameters: location, scale, and slant. When the slant parameter is 0, the distribution reverts to the normal 
  distribution. As the slant parameter increases, the distribution becomes increasingly skewed. In this simulation, slant will be set to 0, 2, 10, 100. 
  Set location and scale to 0 and 1, respectively, for all simulation settings.</p>

<br><br><button type="button" class="btn btn-info" data-toggle="collapse" data-target="#demo">view code</button>
  <div id = "demo" class="collapse">
<code> <br>
  
par(mfrow = c(4,5)) <br>

for (slant in c(0, 2, 10, 100)) { <br>
  <br>
  ## Plot distribution  <br>
  if (slant == 0) { <br>
    curve(dsn(x, xi = location, omega = scale, alpha = slant), -3, 3, main= "Distribution", xlab = "", ylab = paste0("Slant = ", slant), xaxt = "n", yaxt = "n", cex.main = 1.5, cex.lab = 1.5) <br>
  } <br>
  else {<br>
    curve(dsn(x, xi = location, omega = scale, alpha = slant), -3, 3, xlab = "", ylab = paste0("Slant = ", slant), xaxt = "n", yaxt = "n", cex.lab = 1.5)<br>
  }<br>
<br>
  for (N in c(5, 10, 20, 40)) { <br>
    &nbsp;delta <- slant/(sqrt(1+slant^2)) <br>
    &nbsp;pop_mean <- location+scale*delta*(sqrt(2/pi)) <br>
    &nbsp;pop_sd <- sqrt(scale^2*(1-(2*delta^2)/pi)) <br>
    &nbsp;Z <- rnorm(R) <br>
    &nbsp;sample_dist_clt <- Z*(pop_sd/sqrt(N)) + pop_mean <br>
    &nbsp;random.skew <- array(rsn(R*N, xi = location, omega = scale, alpha = slant), dim = c(R,N)) <br>
    &nbsp;sample_dist_sim <- apply(random.skew, 1, mean) <br>
  <br>
    # QQ plot <br>
    if (slant == 0){ <br>
      &nbsp; qqplot(sample_dist_sim, sample_dist_clt, asp = 1, main = paste0("N = ", N), xlab = "", ylab = "", xaxt = "n", yaxt = "n", xlim = c(-1.6,2), ylim = c(-1.6, 2.2), cex.main = 1.5, cex.lab = 1.5) 
      abline(0,1) <br>
      } <br>
    else { <br>
      &nbsp;qqplot(sample_dist_sim, sample_dist_clt, asp = 1, xlab = "", ylab = "", xaxt = "n", yaxt = "n", xlim = c(-1.6,2.2), ylim = c(-1.6, 1.6), cex.lab = 1.5) 
      abline(0,1) <br>
    }<br>
  }<br>
}<br>
<br> 
</code>
</div>

<img class="img-fluid" src="/img/posts/unnamed-chunk-3-1.png">


<h2> Observations </h2>
From the plots above, we can conclude the following:
<ul>
  <li>As the sample size increases, the plotted points fall along the line y=x more precisely</li>
  <li>There will be more deviation in the tails of a plot as the slant increases</li>
</ul>  
